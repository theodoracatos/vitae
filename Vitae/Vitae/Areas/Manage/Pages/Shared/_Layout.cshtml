@inject UserManager<IdentityUser> UserManager
@inject VitaeContext VitaeContext

@{
    var curriculumID = Guid.Parse(User.Claims.Single(c => c.Type == Claims.CURRICULUM_ID).Value);
    var hasPerson = VitaeContext.Curriculums.Include(c => c.Person).Single(c => c.Identifier == curriculumID).Person != null;
}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - Vitae</title>

    <link rel="stylesheet" href="~/css/sbadmin.min.css" />
    <partial name="_Styles" />
</head>

<body class="sb-nav-fixed">
    <nav class="sb-topnav navbar navbar-expand navbar-dark bg-dark">
        <button class="btn btn-link order-1 navbar-toggler d-block" id="sidebarToggle" href="#">
            <span class="navbar-toggler-icon"></span>
        </button>
        <a class="navbar-brand" href="/Manage">
            <img src="~/img/Logo.png" title="Vitae" />
        </a><!-- Navbar Search-->
        <!-- Navbar-->
        <ul class="navbar-nav ml-auto ml-0 mr-3">
            <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle" id="userDropdown" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="fas fa-user fa-fw"></i></a>
                <div class="dropdown-menu dropdown-menu-right" aria-labelledby="userDropdown">
                    <a class="dropdown-item" href="/Identity/Account/Manage/ChangePassword"><i class="fas fa-key fa-fw"></i>@SharedResource.ChangePassword</a>
                    <div class="dropdown-divider"></div>
                    <a class="dropdown-item" href="/Identity/Account/Logout"><i class="fas fa-sign-out-alt fa-fw"></i>@SharedResource.Logout</a>
                </div>
            </li>
        </ul>
    </nav>
    <div id="layoutSidenav">
        <div id="layoutSidenav_nav">
            <nav class="sb-sidenav accordion sb-sidenav-dark" id="sidenavAccordion">
                <div class="sb-sidenav-menu">
                    <div class="nav">
                        <div class="sb-sidenav-menu-heading mt-2">@SharedResource.Overview</div>
                        <a class="nav-link" href="/Manage">
                            <div class="sb-nav-link-icon"><i class="fas fa-chart-line"></i></div>
                            @SharedResource.Dashboard
                        </a>
                        <div class="sb-sidenav-menu-heading mt-2">@SharedResource.PersonalData</div>
                        <a class="nav-link" href="/Manage/@(nameof(Personal))">
                            <div class="sb-nav-link-icon"><i class="fas fa-address-book"></i></div>
                            @SharedResource.PersonalDetails
                        </a>
                        @if (hasPerson)
                        {
                            <a class="nav-link" href="/Manage/@(nameof(About))">
                                <div class="sb-nav-link-icon"><i class="fas fa-image"></i></div>
                                @SharedResource.About
                            </a>
                            <a class="nav-link" href="/Manage/@(nameof(Education))">
                                <div class="sb-nav-link-icon"><i class="fas fa-university"></i></div>
                                @SharedResource.Education
                            </a>
                            <a class="nav-link" href="/Manage/@(nameof(Experience))">
                                <div class="sb-nav-link-icon"><i class="fas fa-briefcase"></i></div>
                                @SharedResource.Experience
                            </a>
                            <a class="nav-link" href="/Manage/@(nameof(Languages))">
                                <div class="sb-nav-link-icon"><i class="fas fa-globe-americas"></i></div>
                                @SharedResource.Languages
                            </a>
                            <a class="nav-link" href="/Manage/@(nameof(Interests))">
                                <div class="sb-nav-link-icon"><i class="fas fa-volleyball-ball"></i></div>
                                @SharedResource.Interests
                            </a>
                            <a class="nav-link" href="/Manage/@(nameof(Awards))">
                                <div class="sb-nav-link-icon"><i class="fas fa-trophy"></i></div>
                                @SharedResource.Awards
                            </a>
                            <a class="nav-link" href="/Manage/@(nameof(Sociallinks))">
                                <div class="sb-nav-link-icon"><i class="fab fa-twitter"></i></div>
                                @SharedResource.SocialLinks
                            </a>
                            <a class="nav-link" href="/Manage/@(nameof(Skills))">
                                <div class="sb-nav-link-icon"><i class="fas fa-tools"></i></div>
                                @SharedResource.Skills
                            </a>
                            <div class="sb-sidenav-menu-heading mt-2">@SharedResource.CurriculumVitae</div>
                            <a class="nav-link" href=@($"/CV/{curriculumID}")>
                                <div class="sb-nav-link-icon"><i class="fas fa-address-card"></i></div>
                                @SharedResource.MyVitae
                            </a>
                        }
                    </div>
                </div>
                <div class="sb-sidenav-footer">
                    <div class="small">@SharedResource.LoggedInAs:</div>
                    <div class="small">
                        @UserManager.GetUserName(User)
                    </div>
                </div>
            </nav>
        </div>
        <div id="layoutSidenav_content">
            <main class="m-3">
                <div class="container-fluid">
                    @RenderBody()
                </div>
            </main>
            <footer class="mt-auto fixed-bottom">
                <div class="container-fluid">
                    <div class="d-flex align-items-center justify-content-end small mr-3">
                        Copyright &copy; @DateTime.Now.Year, Vitae &middot; Made with<font color="red">&nbsp;❤&nbsp;</font> in Switzerland
                        @*<div>
                                <a href="#">Privacy Policy</a>
                                &middot;
                                <a href="#">Terms &amp; Conditions</a>
                            </div>*@
                    </div>
                </div>
            </footer>
        </div>
    </div>

    <partial name="_Scripts" />
    @RenderSection("Scripts", required: false)
</body>
</html>